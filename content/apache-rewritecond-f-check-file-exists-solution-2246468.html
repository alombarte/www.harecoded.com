+++
date = "2013-02-02 19:44:00"
author = "alombarte"
title = "Apache RewriteCond -f check file exists solution"
slug = "apache-rewritecond-f-check-file-exists-solution-2246468"
tags = [ "apache","php","tricks" ]
+++
<p>
  If your Apache <strong>virtualhost or htaccess</strong>
  configuration uses a rewrite condition
  (<strong>RewriteCond</strong>) in order to allow nice URLs, you
  should be aware that since <strong>Apache 2.2 the <strong>"check
  if file or exists"</strong> works a little bit different. Any of
  the following examples might have stopped working for
  you:</strong>
</p>
<pre>
   RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteCond %{REQUEST_FILENAME} !-s
</pre>
<p>
  The solution to correct it is very simple, but I couldn't see it
  documented. All you have to do is to add the variable
  <strong>DOCUMENT_ROOT</strong> before the
  <strong>REQUEST_FILENAME</strong>
</p>
<p>
  The following example redirects all non existing files to
  index.php, here is the difference.
</p>
<p>
  <strong>Before Apache 2.2:</strong>
</p>
<pre>
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^/(.+) /index.php [QSA,L]
</pre>
<p>
  <strong>Apache 2.2 and later:</strong>
</p>
<pre>
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
RewriteRule ^/(.+) /index.php [QSA,L]
</pre>
<p>
  The Apache 2.2 documentation is here: <a href=  "http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</a>
</p>